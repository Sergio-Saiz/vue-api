{"ast":null,"code":"import \"core-js/modules/web.dom-exception.stack.js\";\nimport Vue from 'vue';\nimport Vuex from 'vuex';\nimport router from '../router';\nVue.use(Vuex);\nexport default new Vuex.Store({\n  state: {\n    token: null,\n    username: null,\n    userId: null\n  },\n  mutations: {\n    setToken(state, payload) {\n      state.token = payload;\n    },\n\n    setUserId(state, payload) {\n      state.userId = payload;\n    },\n\n    setUsername(state, payload) {\n      state.username = payload;\n    },\n\n    logout() {\n      localStorage.removeItem('token');\n      localStorage.removeItem('userId');\n      localStorage.removeItem('username');\n      location.href = '/';\n    }\n\n  },\n  actions: {\n    async login({\n      commit\n    }, user) {\n      try {\n        const res = await fetch('http://localhost:250/api/v1/users/login_check', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(user)\n        });\n        const userDB = await res.json();\n        commit('setToken', userDB.token);\n        localStorage.setItem('token', userDB.token);\n        var base64Url = userDB.token.split('.')[1];\n        var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\n        var jsonPayload = decodeURIComponent(window.atob(base64).split('').map(function (c) {\n          return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\n        }).join(''));\n        const tokenPayload = JSON.parse(jsonPayload); // commit('setUser', {id: tokenPayload.id, username: tokenPayload.username})\n        // localStorage.setItem('user', {id: tokenPayload.id, username: tokenPayload.username})\n\n        commit('setUsername', tokenPayload.username);\n        localStorage.setItem('username', tokenPayload.username);\n        commit('setUserId', tokenPayload.id);\n        localStorage.setItem('userId', tokenPayload.id);\n        router.push('User');\n      } catch (error) {\n        console.log('Error: ', error);\n      }\n    },\n\n    async register({\n      commit\n    }, user) {\n      try {\n        const res = await fetch('http://localhost:250/api/v1/users/register', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(user)\n        });\n        const userDB = await res.json();\n        router.push('Login');\n      } catch (error) {\n        console.log('Error: ', error);\n      }\n    },\n\n    getToken({\n      commit\n    }) {\n      if (localStorage.getItem('token')) {\n        commit('setToken', localStorage.getItem('token'));\n      } else {\n        commit('setToken', null);\n      }\n    },\n\n    getUserId({\n      commit\n    }) {\n      if (localStorage.getItem('userId')) {\n        commit('setUserId', localStorage.getItem('userId'));\n      } else {\n        commit('setUserId', null);\n      }\n    },\n\n    getUsername({\n      commit\n    }) {\n      if (localStorage.getItem('username')) {\n        commit('setUsername', localStorage.getItem('username'));\n      } else {\n        commit('setUsername', null);\n      }\n    },\n\n    logout({\n      commit\n    }) {\n      commit('logout');\n    },\n\n    async requestResetPassword({\n      commit\n    }, email) {\n      try {\n        const res = await fetch('http://localhost:250/api/v1/users/request_reset_password', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(email)\n        });\n        const userDB = await res.json();\n        console.log(userDB);\n        router.push('Home');\n      } catch (error) {\n        console.log('Error: ', error);\n      }\n    },\n\n    async resendActivationEmail({\n      commit\n    }, email) {\n      try {\n        const res = await fetch('http://localhost:250/api/v1/users/resend_activation_email', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(email)\n        });\n        const userDB = await res.json();\n        console.log(userDB);\n        router.push('Home');\n      } catch (error) {\n        console.log('Error: ', error);\n      }\n    },\n\n    async activateAccount({\n      commit\n    }, user) {\n      try {\n        const res = await fetch('http://localhost:250/api/v1/users/' + user.id + '/activate', {\n          method: 'PUT',\n          headers: {\n            'Content-Type': 'application/json' // 'Authorization': 'Bearer ' + this.state.token \n\n          },\n          body: JSON.stringify({\n            token: user.token\n          })\n        });\n        const userDB = await res.json();\n        console.log(userDB);\n        router.push('User');\n      } catch (error) {\n        console.log('Error: ', error);\n      }\n    },\n\n    async resetPassword({\n      commit\n    }, user) {\n      try {\n        const res = await fetch('http://localhost:250/api/v1/users/' + user.id + '/reset_password', {\n          method: 'PUT',\n          headers: {\n            'Content-Type': 'application/json' //  'Authorization': 'Bearer ' + this.state.token \n\n          },\n          body: JSON.stringify(user)\n        });\n        const userDB = await res.json();\n        console.log(userDB);\n        router.push('User');\n      } catch (error) {\n        console.log('Error: ', error);\n      }\n    }\n\n  },\n  modules: {}\n});","map":{"version":3,"names":["Vue","Vuex","router","use","Store","state","token","username","userId","mutations","setToken","payload","setUserId","setUsername","logout","localStorage","removeItem","location","href","actions","login","commit","user","res","fetch","method","headers","body","JSON","stringify","userDB","json","setItem","base64Url","split","base64","replace","jsonPayload","decodeURIComponent","window","atob","map","c","charCodeAt","toString","slice","join","tokenPayload","parse","id","push","error","console","log","register","getToken","getItem","getUserId","getUsername","requestResetPassword","email","resendActivationEmail","activateAccount","resetPassword","modules"],"sources":["/home/sergio/code/login-vuejs/src/store/index.js"],"sourcesContent":["import Vue from 'vue'\nimport Vuex from 'vuex'\nimport router from '../router'\n\nVue.use(Vuex)\n\nexport default new Vuex.Store({\n  state: {\n    token: null,\n    username: null,\n    userId: null,\n  },\n  mutations: {\n    setToken(state, payload) {\n      state.token = payload\n    },\n    setUserId(state, payload) {\n      state.userId = payload\n    },\n    setUsername(state, payload) {\n      state.username = payload\n    },\n    logout() {\n      localStorage.removeItem('token')\n      localStorage.removeItem('userId')\n      localStorage.removeItem('username')\n      location.href='/'\n    },\n  },\n  actions: {\n    async login({ commit }, user) {\n      try {\n        const res = await fetch('http://localhost:250/api/v1/users/login_check', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify(user)\n        })\n        const userDB = await res.json()\n        commit('setToken', userDB.token)\n        localStorage.setItem('token', userDB.token)\n\n        var base64Url = userDB.token.split('.')[1];\n        var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\n        var jsonPayload = decodeURIComponent(window.atob(base64).split('').map(function(c) {\n            return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\n        }).join(''));\n    \n        const tokenPayload = JSON.parse(jsonPayload)\n        // commit('setUser', {id: tokenPayload.id, username: tokenPayload.username})\n        // localStorage.setItem('user', {id: tokenPayload.id, username: tokenPayload.username})\n        commit('setUsername', tokenPayload.username)\n        localStorage.setItem('username', tokenPayload.username)\n        commit('setUserId', tokenPayload.id)\n        localStorage.setItem('userId', tokenPayload.id)\n\n        router.push('User');\n         \n      } catch (error) {\n        console.log('Error: ', error)\n      }\n      \n    },\n    async register({ commit },  user ) {\n      try {\n        const res = await fetch('http://localhost:250/api/v1/users/register', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },  \n          body: JSON.stringify(user)\n        })\n        const userDB = await res.json()\n        router.push('Login');\n      } catch (error) {\n        console.log('Error: ', error)\n      }\n    },\n    getToken({commit}) {\n      if(localStorage.getItem('token')) {\n        commit('setToken', localStorage.getItem('token'))\n      } else {\n        commit('setToken', null)\n      }\n    },\n    getUserId({commit}) {\n      if(localStorage.getItem('userId')) {\n        commit('setUserId', localStorage.getItem('userId'))\n      } else {\n        commit('setUserId', null)\n      }\n    },\n    getUsername({commit}) {\n      if(localStorage.getItem('username')) {\n        commit('setUsername', localStorage.getItem('username'))\n      } else {\n        commit('setUsername', null)\n      }\n    },\n    logout ({ commit }) {\n      commit('logout')\n    },\n\n\n    async requestResetPassword({commit}, email ) {\n      try {\n        const res = await fetch('http://localhost:250/api/v1/users/request_reset_password', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },  \n          body: JSON.stringify(email)\n        })\n        const userDB = await res.json()\n        console.log(userDB)\n        router.push('Home');\n      } catch (error) {\n        console.log('Error: ', error)\n      }\n    },\n\n    async resendActivationEmail({commit}, email ) {\n      try {\n        const res = await fetch('http://localhost:250/api/v1/users/resend_activation_email', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },  \n          body: JSON.stringify(email)\n        })\n        const userDB = await res.json()\n        console.log(userDB)\n        router.push('Home');\n      } catch (error) {\n        console.log('Error: ', error)\n      }\n    },\n\n    async activateAccount({ commit }, user ) {\n      try {\n        const res = await fetch('http://localhost:250/api/v1/users/' + user.id + '/activate', {\n          method: 'PUT',\n          headers: {\n            'Content-Type': 'application/json',\n           // 'Authorization': 'Bearer ' + this.state.token \n          },  \n          body: JSON.stringify({token: user.token})\n        })\n        const userDB = await res.json()\n        console.log(userDB)\n        router.push('User');\n      } catch (error) {\n        console.log('Error: ', error)\n      }\n      \n    },\n\n    async resetPassword({ commit }, user ) {\n      try {\n        const res = await fetch('http://localhost:250/api/v1/users/' + user.id + '/reset_password', {\n          method: 'PUT',\n          headers: {\n            'Content-Type': 'application/json',\n          //  'Authorization': 'Bearer ' + this.state.token \n          },  \n          body: JSON.stringify(user)\n        })\n        const userDB = await res.json()\n        console.log(userDB)\n        router.push('User');\n      } catch (error) {\n        console.log('Error: ', error)\n      }\n\n    },\n  \n  },\n  modules: {\n  }\n})\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}